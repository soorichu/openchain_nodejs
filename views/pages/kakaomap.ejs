<!DOCTYPE html>
<html>
<head>
  <% include ../partials/header.ejs %>

</head>

<body>

<% include ../partials/nav.ejs %>

<div id="map" style="width:100%;height:500px;margin:0px;padding:0px;"></div>
<button onclick="geoLocation()">홈</button>
<button onclick="zoomIn()">+</button>
<button onclick="zoomOut()">-</button>
<button onclick="getInfo()">정보</button>
<p id="message"></p>

  <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=a75d32760d32a92755d0ea6821498916"></script>
  <script>
    var container = document.getElementById('map');
    var options = {
      center: new kakao.maps.LatLng(37.533796, 126.637316),
      level: 3
    };

    var map = new kakao.maps.Map(container, options);
    var mapTypeControl = new kakao.maps.MapTypeControl();
    map.addControl(mapTypeControl, kakao.maps.ControlPosition.TOLEFT);

    geoLocation();


    function panTo(){
    	var moveLatLon = new kakao.maps.LatLng(37.533796, 126.637316);
    	map.panTo(moveLatLon);
    }

    function zoomIn(){
    	var level = map.getLevel();
    	map.setLevel(level-1);
    }

    function zoomOut(){
    	var level = map.getLevel();
    	map.setLevel(level+1);
    }

    function getInfo(){
    	var center = map.getCenter();
    	var level = map.getLevel();
    	var mapTypeId = map.getMapTypeId();
    	var bounds = map.getBounds();
    	var swLatLng = bounds.getSouthWest();
    	var neLatLng = bounds.getNorthEast();
    	var boundStr = bounds = toString();

    	var message = "지도 중심좌표 : 위도 " + center.getLat() +", 경도 " + center.getLng()
    				+ "<br>지도 레벨 : " + level 
    				+ "<br>지도 타입 : " + mapTypeId
    				+ "<br>남서쪽 좌표 : " + swLatLng.getLat() + ", " + swLatLng.getLng()
    				+ "<br>북서쪽 좌표 : " + neLatLng.getLat() + ", " + neLatLng.getLng();

    	document.getElementById("message").innerHTML = message;
    }

	function geoLocation(){
		if (navigator.geolocation) {
	    
	    navigator.geolocation.getCurrentPosition(function(position) {
	        
	        var lat = position.coords.latitude, // 위도
	            lon = position.coords.longitude; // 경도
	        
	        var locPosition = new kakao.maps.LatLng(lat, lon), 
	            message = '<div style="padding:2px;">현재 위치 입니다.</div>'; 
	        
	        displayMarker(locPosition, message);
	            
	      });
	    
		} else { 
		    var locPosition = new kakao.maps.LatLng(33.450701, 126.570667),    
		        message = '현재 위치 사용 불가'
		        
		    displayMarker(locPosition, message);
		}

	}


	function displayMarker(locPosition, message) {

	    var marker = new kakao.maps.Marker({  
	        map: map, 
	        position: locPosition
	    }); 
	    
	    var iwContent = message, iwRemoveable = true;

	    var infowindow = new kakao.maps.InfoWindow({
	        content : iwContent,
	        removable : iwRemoveable
	    });
	    
	    infowindow.open(map, marker);
	    
	    map.setCenter(locPosition);      
	}    
  </script>
</body>
</html>
